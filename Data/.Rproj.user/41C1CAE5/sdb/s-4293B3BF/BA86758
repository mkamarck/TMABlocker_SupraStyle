{
    "contents" : "library(reshape2)\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(drc)\n\n#Import Data_ Exp3####\nsubj <- dir(path = \"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Raw Data/DR_Agitated\", pattern=\"\\\\.txt$\", full.names=TRUE) # creating a list of all file names\nnames(subj)  <- basename(subj)\ndf.jars.agit <- ldply(subj, read.delim, stringsAsFactors=FALSE) \ndf.jars.agit <- subset(df.jars.agit, select = c(\"Subject\",\"Session\", \"Trial\", \"valve\", \"valve2\", \"TrainList\", \"Running.Block.\", \"IntensityRating\")) \ndf.jars.agit$IntensityRating.inv <- 580-as.integer(df.jars.agit$IntensityRating)\n\n\n#Trial Data\ndf.trialJars <- subset(df.jars.agit, Running.Block. == \"Test\", select = c(\"Subject\", \"Session\", \"Trial\", \"valve\", \"valve2\", \"Running.Block.\", \"IntensityRating.inv\"))\n#write.csv(df.trial, \"TMA_supra_9.csv\") #give this to Dardalie to import\n\n\n#import the file that has the trial types\nvalve.list <- read.csv(\"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis/TMA_DR_merge.csv\")\n\n#merge with trial list\ndf.trial_merge <- merge(df.trialJars, valve.list)\n\n#For Test-Retest btwn trial 1 and 2######\nExp3retest.df <- subset(df.trial_merge, Subject!=1000)\n\n#Setup df that splits Trials -- 52 rounds , 13 sessions per trial\nExp3retestT1 <- subset(Exp3retest.df,Trial<= 13)# df with Inten.Rate from  trial 1\nExp3retestT2 <- subset(Exp3retest.df,Trial>13 & Trial<=26)#df with Inten.Rate from  trial 2\nExp3retestT1 <- Exp3retestT1[,c(-1,-3,-4,-5)] #get rid of column w/ trial and Session numbers\nExp3retestT2 <- Exp3retestT2[,c(-1,-3,-4,-5)] \ncolnames(Exp3retestT1)[3] <- \"trial1\"\ncolnames(Exp3retestT2)[3] <- \"trial2\"\n\n\nOnevTwoExp3.trials <- merge(Exp3retestT1,Exp3retestT2)#merge the dataframes for T1 and T2\ncolnames(OnevTwoExp3.trials)[3] <- \"Concentration\"  #renames column 8 to conc...\n\n\n\n#Do the correlation\ntestExp3.corr <- ddply(OnevTwoExp3.trials, .variables = \"Subject\", function(x) trial.cor = cor(x$trial1, x$trial2))\ntestExp3.corr$trial.corr <- abs(testExp3.corr$V1)#takes abs. value of correlation values\n\n\n\n\n\n\n\n#Import Data Exp1###\nsubject <- dir(path = \"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Raw Data/Test1_olfactometer\", pattern=\"\\\\.txt$\", full.names=TRUE)# creating a list of all file names\n#subj <- dir(path = \"/Volumes/mainland/Projects/TMA\\ blocker/SupraStyle/Data/Raw\\ Data/Test1_olfactometer\", pattern=\"\\\\.txt$\", full.names=TRUE)# on mac - creating a list of all file names\n\nnames(subject)  <- basename(subject)\ndf  <- ldply(subject, read.delim, stringsAsFactors=FALSE) \n\n#subset variables\ndf <- subset(df, select = c(\"Subject\", \"Trial\", \"valve\", \"valve2\", \"TrainList\", \"Running.Block.\", \"IntensityRating\"))\ndf$IntensityRating.inv <- 580-as.integer(df$IntensityRating)\n\n#Trial Data\ndf.trial <- subset(df, Running.Block. == \"Test\", select = c(\"Subject\", \"Trial\", \"valve\", \"valve2\", \"Running.Block.\", \"IntensityRating.inv\"))\n\n#import the file that has the trial types\nvalve.list.exp1 <- read.csv(\"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis/TMA_supra_highTMA_merge.csv\") #for a pc\n#valve.list <- read.csv(\"/Volumes/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis/TMA_supra_highTMA_merge.csv\") #for a mac\n\n#merge with trial list\ndf.trial_merge.1 <- merge(df.trial, valve.list.exp1)\n\nExp1.TMAretest.df <- df.trial_merge.1\nExp1.TMAretest.df <- Exp1.TMAretest.df[Exp1.TMAretest.df$Type==\"TMA\",]#subset w/ only TMA data\nExp1.TMAretest.df <- subset(Exp1.TMAretest.df, !Subject %in% c(\"14\",\"16\",\"18\",\"36\")) # Removes thes subjects, make p-value higher\n#Setup df that splits and renames IntensityRating as Trial1/Trial2\n\nexp1.TMAretestRename1 <- subset(Exp1.TMAretest.df,Trial<= 40)# df with Inten.Rate from  trial 1 \nexp1.TMAretestRename2 <- subset(Exp1.TMAretest.df,Trial> 40)#df with Inten.Rate from  trial 2\nexp1.TMAretestRename1 <- exp1.TMAretestRename1[,-4] #get rid of trial numbers\nexp1.TMAretestRename2 <- exp1.TMAretestRename2[,-4] #get rid of trial numbers\ncolnames(exp1.TMAretestRename1)[5] <- \"Trial1\"  # rename Intensity column \"trial1\"\ncolnames(exp1.TMAretestRename2)[5] <- \"Trial2\"\nexp1.testTMA.trials <- merge(exp1.TMAretestRename1,exp1.TMAretestRename2)#merge the dataframes\n\n#Do the correlation\nexp1.testTMA.corr <- ddply(exp1.testTMA.trials, .variables = c(\"Subject\", \"Type\"), function(x) trial.cor = cor(x$Trial1, x$Trial2))\nexp1.testTMA.corr$trial.corr <- abs(exp1.testTMA.corr$V1)#takes abs. value of correlation values\n\n\n\n\n\n\n\n#Correlaton by Exp #####\nexp1.testTMA.corr <- exp1.testTMA.corr[,-2] #Deletes column 2 from df\n\nexp1.testTMA.corr$exp <- 1 #Creates new column to ID values from Exp.1\ntestExp3.corr$exp <- 3    #Creates new column to ID values from Exp.3\n\n\nretest.exp1v3 <- rbind(testExp3.corr,exp1.testTMA.corr) #combines dataframes by column\n\n\n#Do the correlation\n\nstatsCorrelation.exp1Vexp3 <- t.test(trial.corr~exp, data = subset(retest.exp1v3), paired = F)\nstatsCorrelation.exp1Vexp3\n\nggplot(retest.exp1v3, aes(x=exp, y = trial.corr))+\n  geom_point()\n\n######################################\n\n#Marissa is comparing testRetest.Exp1 to testRetest.Exp3\n\n#####################################\ntestRetest.Exp3$Type <- \"TMA\" #make row names match\ntestRetest.1and3 <- rbind(testRetest.Exp1, testRetest.Exp3) #combine\n\ntest <- t.test(trial.corr~Experiment, data = testRetest.1and3)\ntest\n\nggplot(testRetest.1and3, aes(x = factor(Experiment), y = trial.corr)) +\n  geom_point() +\n  ylim(0,1)\n",
    "created" : 1502225555096.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1883578970",
    "id" : "BA86758",
    "lastKnownWriteTime" : 1502227664,
    "path" : "/Volumes/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis_DB/TMA Ratings_Exp 1 vs Exp 3.R",
    "project_path" : "Analysis_DB/TMA Ratings_Exp 1 vs Exp 3.R",
    "properties" : {
    },
    "relative_order" : 13,
    "source_on_save" : false,
    "type" : "r_source"
}