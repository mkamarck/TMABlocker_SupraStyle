{
    "contents" : "#Import Libraries####\nlibrary(reshape2)\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(drc)\n\n\n#Import Data\nsubj <- dir(path = \"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Raw Data/Test1_olfactometer\", pattern=\"\\\\.txt$\", full.names=TRUE)# creating a list of all file names\n#subj <- dir(path = \"/Volumes/mainland/Projects/TMA\\ blocker/SupraStyle/Data/Raw\\ Data/Test1_olfactometer\", pattern=\"\\\\.txt$\", full.names=TRUE)# on mac - creating a list of all file names\n\nnames(subj)  <- basename(subj)\ndf  <- ldply(subj, read.delim, stringsAsFactors=FALSE) \n\n#subset variables\ndf <- subset(df, select = c(\"Subject\", \"Trial\", \"valve\", \"valve2\", \"TrainList\", \"Running.Block.\", \"IntensityRating\"))\ndf$IntensityRating.inv <- 580-as.integer(df$IntensityRating)\n\n#Trial Data\ndf.trial <- subset(df, Running.Block. == \"Test\", select = c(\"Subject\", \"Trial\", \"valve\", \"valve2\", \"Running.Block.\", \"IntensityRating.inv\"))\n\n#import the file that has the trial types\nvalve.list <- read.csv(\"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis/TMA_supra_highTMA_merge.csv\") #for a pc\n#valve.list <- read.csv(\"/Volumes/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis/TMA_supra_highTMA_merge.csv\") #for a mac\n\n#merge with trial list\ndf.trial_merge <- merge(df.trial, valve.list)\n\n\n# ggplot(subset(df.trial_merge, Subject == 8), aes(x = Concentration, y = IntensityRating.inv, colour = Type))+\n#   geom_point() +\n#   facet_wrap(~Type)\n\n\n#TMAretest.df <- subset(df.trial_merge, Subject=5 & Type==\"TMA\") # need & when connecting booleans\n# TMAtest.df <- df.trial_merge[df.trial_merge$Subject==5,]\n# TMAretest.df <- TMAtest.df[TMAtest.df$Type==\"TMA\",]\n\n#For Test-Retest######\nTMAretest.df <- df.trial_merge\n\n#Setup df that splits and renames IntensityRating as Trial1/Trial2\n\nTMAretestRename1 <- subset(TMAretest.df,Trial<= 40)# df with Inten.Rate from  trial 1 \nTMAretestRename2 <- subset(TMAretest.df,Trial> 40)#df with Inten.Rate from  trial 2\nTMAretestRename1 <- TMAretestRename1[,-4] #get rid of trial numbers\nTMAretestRename2 <- TMAretestRename2[,-4] #get rid of trial numbers\ncolnames(TMAretestRename1)[5] <- \"Trial1\"  # rename Intensity column \"trial1\"\ncolnames(TMAretestRename2)[5] <- \"Trial2\"\ntestTMA.trials <- merge(TMAretestRename1,TMAretestRename2)#merge the dataframes\n\n#graph the trials\nggplot(data = subset(testTMA.trials), aes(x = Trial1, y = Trial2, color = Type)) +\n  geom_point() +\n  facet_wrap(~Subject)\n\n#Do the correlation\ntestTMA.corr <- ddply(testTMA.trials, .variables = c(\"Subject\", \"Type\"), function(x) trial.cor = cor(x$Trial1, x$Trial2))\ntestTMA.corr$trial.corr <- abs(testTMA.corr$V1)#takes abs. value of correlation values\n\nggplot(testTMA.corr, aes(x = Type, y = trial.corr)) +\n  geom_point() +\n  facet_wrap(~Subject)\n\n\nggplot(testTMA.corr, aes(x = Type, y = trial.corr, color = factor(Subject))) +\n  geom_point() \n\nggplot(subset(testTMA.corr, Type == \"TMA\"), aes(x = Subject, y = trial.corr))+\n  geom_point() +\n  ylim(0,1)\n\ntestRetest.Exp1 <- subset(testTMA.corr, Type == \"TMA\")\ntestRetest.Exp1$Experiment <- 1\n\n#one option for comparing TMA to Linalool in terms of consistency#### Paired t-test \npng(\"figures/allSubjectsTMAlwrCorrLinalool.png\",width = 200, height = 360,units = \"px\")\nggplot(subset(testTMA.corr, Type %in% c(\"TMA\", \"Linalool\") & !Subject %in% c(\"14\",\"16\",\"18\",\"36\")), aes(x = Type, y = trial.corr, color = factor(Subject), group = Subject)) +\n  geom_point() +\n  geom_line()+\n  ggtitle(\"Test-Retest Correlation\") +\n  xlab(\"\") + \n  ylab(\"Intensity Rating Correlation Coefficient\")+\n  theme(legend.position = \"none\")\n  #theme_bw() \ndev.off()\n\n#Another option for comparing TMA to Linalool in terms of consistency####  \nggplot(subset(testTMA.corr, Type %in% c(\"TMA\", \"Linalool\") & !Subject %in% c(\"14\",\"16\",\"18\",\"36\")), aes(x = Type, y = trial.corr, color = factor(Subject), group = Subject)) +\n  geom_point() +\n  geom_abline(a = 0, y = 1)+\n  xlim(0,1) +\n  ylim(0,1)+\n  ggtitle(\"Test-Retest Correlation\") +\n  xlab(\"Linalool test-retest\") + \n  ylab(\" TMA test-retest\")+\n  theme(legend.position = \"none\")\n\n\n\n#Paired t-test#####\nstatsCorrelation <- t.test(trial.corr~Type, data = subset(testTMA.corr, Type %in% c(\"TMA\", \"Linalool\") & !Subject %in% c(\"14\",\"16\",\"18\",\"36\")), paired = TRUE)\nstatsCorrelation\n\n#can we prove that TMA is rated lower than linalool? anova#########\naov.TMAvLinalool <- aov(IntensityRating.inv~Type*Concentration, data = subset(df.trial_merge, Type %in% c(\"TMA\", \"Linalool\") & !Subject %in% c(\"14\",\"16\",\"18\",\"36\")))\nsummary(aov.TMAvLinalool)\n\n\n\n\n\n########broken code ######\nslope.correl.graphs <- matrix(1:3)\nfor (i in 1:3){\n  temp <- subset(testTMA.trials,Subject==i)\n  fit=lm(Trial1~Trial2,data=testTMA.trials)  #fits linear model to data\n  slope.correl.graphs[i] <- fit$coefficients[2]\n}\n\n\n\n\n\n\n",
    "created" : 1502225350969.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2100410991",
    "id" : "592F8B6D",
    "lastKnownWriteTime" : 1502225677,
    "path" : "/Volumes/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis_DB/Test-Retest for Exp- 1 Data.R",
    "project_path" : "Analysis_DB/Test-Retest for Exp- 1 Data.R",
    "properties" : {
    },
    "relative_order" : 12,
    "source_on_save" : false,
    "type" : "r_source"
}