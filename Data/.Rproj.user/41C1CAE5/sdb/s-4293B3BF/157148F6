{
    "contents" : "library(reshape2)\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(drc)\n\n\n#Import Data####\nsubj <- dir(path = \"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Raw Data/DR_Agitated\", pattern=\"\\\\.txt$\", full.names=TRUE) # creating a list of all file names\nnames(subj)  <- basename(subj)\ndf.jars.agit <- ldply(subj, read.delim, stringsAsFactors=FALSE) \ndf.jars.agit <- subset(df.jars.agit, select = c(\"Subject\",\"Session\", \"SessionDate\", \"SessionStartDateTimeUtc\", \"Trial\", \"valve\", \"valve2\", \"TrainList\", \"Running.Block.\", \"IntensityRating\")) \ndf.jars.agit$IntensityRating.inv <- 580-as.integer(df.jars.agit$IntensityRating)\n\n\n#Trial Data\ndf.trialJars <- subset(df.jars.agit, Running.Block. == \"Test\", select = c(\"Subject\", \"Session\", \"Trial\", \"valve\", \"valve2\", \"Running.Block.\", \"IntensityRating.inv\",\"SessionDate\", \"SessionStartDateTimeUtc\"))\n#write.csv(df.trial, \"TMA_supra_9.csv\") #give this to Dardalie to import\n\n\n#import the file that has the trial types\nvalve.list <- read.csv(\"//monell/storage/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis/TMA_DR_merge.csv\")\n\n#merge with trial list\ndf.trial_merge <- merge(df.trialJars, valve.list)\n\n#For Test-Retest btwn trial 1 and 2######\nExp3retest1v2.df <- subset(df.trial_merge, Subject!=1000)\n\n#Setup df that splits Trials -- 52 rounds , 13 sessions per trial\nExp3retestT1 <- subset(Exp3retest1v2.df,Trial<= 13)# df with Inten.Rate from  trial 1+2 \nExp3retestT2 <- subset(Exp3retest1v2.df,Trial>13 & Trial<=26)#df with Inten.Rate from  trial 3+4\nExp3retestT1 <- Exp3retestT1[,c(-1,-3,-4,-5)] #get rid of column w/ trial,valves and Session numbers\nExp3retestT2 <- Exp3retestT2[,c(-1,-3,-4,-5)] \ncolnames(Exp3retestT1)[3] <- \"trial1\"\ncolnames(Exp3retestT2)[3] <- \"trial2\"\ntestExp3.trials <- merge(Exp3retestT1,Exp3retestT2)#merge the dataframes\n\n\n#graph the trials\nggplot(data = subset(testExp3.trials), aes(x = trial1, y = trial2)) +\n  geom_point() +\n  facet_wrap(~Subject)\n\n#Do the correlation\ntestExp3.corr <- ddply(testExp3.trials, .variables = c(\"Subject\", \"Concentration\"), function(x) trial.cor = cor(x$trial1, x$trial2))\ntestExp3.corr$trial.corr <- abs(testExp3.corr$V1)#takes abs. value of correlation values\n\n\nggplot(testExp3.corr, aes(x = NA, y = trial.corr)) +\n  geom_point() +\nfacet_wrap(~Subject)\n\n###### Graph of Session&Time against correlation coeff for trials 1 and 2\ntestExp3.corr$SubjectOrder <- factor(testExp3.corr$Subject, levels = c(11, 50, 29, 33, 56, 49, 59, 58, 62, 54, 53), labels = c(1,2,3,4,5,6,7,8,9,10,11))\nggplot(testExp3.corr, aes(x = SubjectOrder, y = trial.corr)) +\n  geom_point() #+\n  #facet_wrap(~Subject)\n#fit=lm(SessionStartDateTimeUtc~trial.corr,data=testExp3.corr) \n\n\n########## relabel to reorder input in column by rows \n  #datafram.df$column.name <- factor(levels=c\"rowname.1\",\"rowname.2\"\"etc...\"),labels=c(\"label for 1st level\",\"etc...\")\n\n\n\n\n#For Test-Retest btwn trial 1 and 3######\nExp3retest1v3.df <- subset(df.trial_merge, Subject!=1000)\n\n#Setup df that splits Trials -- 52 rounds , 13 sessions per trial####\nE3.1v3.retestT1 <- subset(Exp3retest1v3.df,Trial<= 13)# df with Inten.Rate from  trial 1+2 \nE3.1v3.retestT2 <- subset(Exp3retest1v3.df,Trial>26 & Trial<=39)#df with Inten.Rate from  trial 3+4\nE3.1v3.retestT1 <- E3.1v3.retestT1[,c(-1,-3,-4,-5)] #get rid of column w/ trial,valves and Session numbers\nE3.1v3.retestT2 <- E3.1v3.retestT2[,c(-1,-3,-4,-5)] \ncolnames(E3.1v3.retestT1)[3] <- \"trial1\"\ncolnames(E3.1v3.retestT2)[3] <- \"trial2\"\ntest.1v3.E3.trials <- merge(E3.1v3.retestT1,E3.1v3.retestT2)#merge the dataframes\n\n\n\n#graph the trials 1v3\nggplot(data = subset(test.1v3.E3.trials), aes(x = trial1, y = trial2)) +\n  geom_point() +\n  facet_wrap(~Subject)\n\n#Do the correlation 1v4\ntestExp3.corr <- ddply(test.1v3.E3.trials, .variables = c(\"SessionStartDateTimeUtc\",\"Subject\"), function(x) trial.cor = cor(x$trial1, x$trial2))\ntestExp3.corr$trial.corr <- abs(testExp3.corr$V1)#takes abs. value of correlation values\n\n\nggplot(test.1v3.E3.trials, aes(x = NA, y = trial.corr)) +\n  geom_point() +\n  facet_wrap(~Subject)\n\n###### Graph of Session&Time against correlation coeff for trials 1 and 2\nggplot(testExp3.corr, aes(x = SessionStartDateTimeUtc, y = trial.corr)) +\n  geom_point() #+\n#facet_wrap(~Subject)\n#fit=lm(SessionStartDateTimeUtc~trial.corr,data=testExp3.corr) \n\ndf.trial_merge$SubjectOrder <- factor(df.trial_merge$Subject, levels = c(11, 50, 29, 33, 56, 49, 59, 58, 62, 54, 53), labels = c(1,2,3,4,5,6,7,8,9,10,11))\n\nggplot(df.trial_merge, aes(x = TMA.Concentration, y = IntensityRating.inv, color = Subject))+\n  geom_point()+\n  facet_wrap(~SubjectOrder)\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1502224848059.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2226452150",
    "id" : "157148F6",
    "lastKnownWriteTime" : 1502228292,
    "path" : "/Volumes/mainland/Projects/TMA blocker/SupraStyle/Data/Analysis_DB/Exp 3 Test Retest.R",
    "project_path" : "Analysis_DB/Exp 3 Test Retest.R",
    "properties" : {
    },
    "relative_order" : 11,
    "source_on_save" : false,
    "type" : "r_source"
}